(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{378:function(t,a,s){t.exports=s.p+"assets/img/memoizeProps.3da08142.png"},379:function(t,a,s){t.exports=s.p+"assets/img/dom-fiber.822d9e77.png"},380:function(t,a,s){t.exports=s.p+"assets/img/clickLifeCycle_1.ce1716d7.png"},381:function(t,a,s){t.exports=s.p+"assets/img/clickLifeCycle_2.a8765945.png"},382:function(t,a,s){t.exports=s.p+"assets/img/clickLifeCycle_3.e3606d8c.png"},455:function(t,a,s){"use strict";s.r(a);var n=s(45),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"事件原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#事件原理"}},[t._v("#")]),t._v(" 事件原理")]),t._v(" "),n("h2",{attrs:{id:"一、前言"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、前言"}},[t._v("#")]),t._v(" 一、前言")]),t._v(" "),n("h3",{attrs:{id:"首先"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#首先"}},[t._v("#")]),t._v(" 首先")]),t._v(" "),n("p",[t._v('在React应用中，我们所看到的React事件都是"假的"。假在哪里？')]),t._v(" "),n("ul",[n("li",[t._v("给元素绑定的事件，不是真正的事件处理函数。")]),t._v(" "),n("li",[t._v("在冒泡/捕获阶段绑定的事件，也不是在冒泡/捕获阶段执行的。")]),t._v(" "),n("li",[t._v("甚至在事件处理函数中拿到的事件源e，也不是真正的事件源e。")])]),t._v(" "),n("h3",{attrs:{id:"疑问"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#疑问"}},[t._v("#")]),t._v(" 疑问")]),t._v(" "),n("ul",[n("li",[t._v("React 为什么有自己的事件系统？")]),t._v(" "),n("li",[t._v("什么是事件合成 ？")]),t._v(" "),n("li",[t._v("如何实现的批量更新？")]),t._v(" "),n("li",[t._v("事件系统如何模拟冒泡和捕获阶段？")]),t._v(" "),n("li",[t._v("如何通过 dom 元素找到与之匹配的fiber？")]),t._v(" "),n("li",[t._v("为什么不能用 return false 来阻止事件的默认行为？")]),t._v(" "),n("li",[t._v("事件是绑定在真实的dom上吗？如何不是绑定在哪里？")]),t._v(" "),n("li",[t._v("V17 对事件系统有哪些改变？")])]),t._v(" "),n("p",[t._v("由于不是绑定在真实的DOM上，所以React需要模拟一套事件流：事件捕获 -> 事件源 -> 事件冒泡, 也包括重写\n一下事件源对象event。")]),t._v(" "),n("h2",{attrs:{id:"二、独特的事件处理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、独特的事件处理"}},[t._v("#")]),t._v(" 二、独特的事件处理")]),t._v(" "),n("h3",{attrs:{id:"_2-1冒泡阶段和捕获阶段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1冒泡阶段和捕获阶段"}},[t._v("#")]),t._v(" 2.1冒泡阶段和捕获阶段")]),t._v(" "),n("ul",[n("li",[t._v("冒泡阶段：开发者正常给React绑定的事件加上onClick，onChange。默认会在模拟冒泡阶段执行。")]),t._v(" "),n("li",[t._v("捕获阶段：如果想要在捕获阶段执行可以将事件后面加上Capture后缀，比如onClickCapture，onChangeCapture")])]),t._v(" "),n("h3",{attrs:{id:"_2-2阻止冒泡"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2阻止冒泡"}},[t._v("#")]),t._v(" 2.2阻止冒泡")]),t._v(" "),n("p",[t._v("React阻止冒泡和原生事件中的写法差不多，e.stopPropagation()；但底层原理不同。")]),t._v(" "),n("h3",{attrs:{id:"_2-3阻止默认行为"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3阻止默认行为"}},[t._v("#")]),t._v(" 2.3阻止默认行为")]),t._v(" "),n("ul",[n("li",[t._v("原生事件：e.preventDefault()和return false可以用来阻止事件默认行为。")]),t._v(" "),n("li",[t._v("React事件: e.preventDefault()阻止事件默认行为，这个方法并非是原生事件的preventDefault,\n由于React的事件源e也是独立组建的，所以需要显示调用preventDefault来告诉react来阻止默认行为，所以\nreturn false在react应用中完全失去来作用。")])]),t._v(" "),n("h2",{attrs:{id:"三、事件合成"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、事件合成"}},[t._v("#")]),t._v(" 三、事件合成")]),t._v(" "),n("p",[t._v("React事件系统可分为三个部分：")]),t._v(" "),n("ul",[n("li",[t._v("第一部分是在事件合成系统，初始化会注册不同的事件插件。")]),t._v(" "),n("li",[t._v("第二部分是在第一次渲染过程中，对事件标签中事件的收集，想container注册事件。")]),t._v(" "),n("li",[t._v("第三个部分就是一次用户交互，事件触发，到事件执行的一系列过程。")])]),t._v(" "),n("h3",{attrs:{id:"_3-1事件合成概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1事件合成概念"}},[t._v("#")]),t._v(" 3.1事件合成概念")]),t._v(" "),n("ul",[n("li",[t._v("React的事件不是绑定在元素上，而是统一绑定在顶部容器上，在V17之前是绑定在document上的，在\nV17改变成了app容器。这样更利于一个html下存在多个应用（微前端）。")]),t._v(" "),n("li",[t._v("绑定事件并不是一次性绑定所有事件，比如发现了onClick事件，就回绑定click事件，比如发现了onChange事件，\n会绑定[blur, change, focus, keydown, keyup]多个事件。")]),t._v(" "),n("li",[t._v("React事件合成的概念：React应用中，元素绑定的事件并不是原生事件，而是React合成的事件，比如onClick是由\nclick合成，onChange是由blur，change，focus等多个事件合成。")])]),t._v(" "),n("h3",{attrs:{id:"_3-2-事件插件机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-事件插件机制"}},[t._v("#")]),t._v(" 3.2 事件插件机制")]),t._v(" "),n("p",[t._v("React有一种事件插件机制，比如onClick和onChange，会有不同的事件插件SimpleEventPlugin，\nChangeEventPlugin处理。")]),t._v(" "),n("p",[t._v("registration： 登记，注册")]),t._v(" "),n("h4",{attrs:{id:"第一个registrationnamemodules"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第一个registrationnamemodules"}},[t._v("#")]),t._v(" 第一个registrationNameModules：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("simple"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'简单的'")]),t._v("\ncapture"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'捕获'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" registrationNameModules "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  onBlur"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" SimpleEventPlugin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onClick"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" SimpleEventPlugin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onClickCapture"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" SimpleEventPlugin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onChange"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ChangeEventPlugin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onChangeCapture"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ChangeEventPlugin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onMouseEnter"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" EnterEventPlugin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onMouseLeave"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" EnterEventPlugin\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("registrationNameModules记录了React事件和与之对应的处理插件的映射。")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("为什么要用不同的事件插件来处理不同的React事件")]),t._v(" "),n("p",[t._v("答：首先对于不用的事件，有不同的处理逻辑；对应的事件源对象也有所不同，React的事件和事件源是自己合成的，\n所以对于不同事件需要不同的事件插件处理。")])]),t._v(" "),n("h4",{attrs:{id:"第二个registrationnamedependencies"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第二个registrationnamedependencies"}},[t._v("#")]),t._v(" 第二个registrationNameDependencies")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  onBlur"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'blur'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onClick"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onClickCapture"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onChange"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'blur'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'change'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'focus'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'input'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'keydown'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'keyup'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'selectionchange'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onMouseEnter"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mouseout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mouseover'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  onMouseLeave"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mouseout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mouseover'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("这个对象保存了React事件和原生事件对应关系，这就解释了为什么上述只写了一个onChange，会有很多的原生\n事件绑定在document上。在事件绑定阶段，如果发现有React事件，比如onChange，就会找到对应的原生事件数组，逐一绑定。")]),t._v(" "),n("h2",{attrs:{id:"四、事件绑定"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四、事件绑定"}},[t._v("#")]),t._v(" 四、事件绑定")]),t._v(" "),n("p",[t._v("所谓事件绑定，就是在React处理props时候，如果遇到事件比如onClick，就会通过addEventListener注册原生事件，\n例如onClick最后去了哪里？")]),t._v(" "),n("p",[t._v("最后去了fiber下memoizedProps属性上，如上结构会变成这样。\n"),n("img",{attrs:{src:s(378),alt:"memoizedProps"}}),t._v(";")]),t._v(" "),n("h2",{attrs:{id:"五、事件触发"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#五、事件触发"}},[t._v("#")]),t._v(" 五、事件触发")]),t._v(" "),n("p",[t._v("一次点击事件")]),t._v(" "),n("div",{staticClass:"language-jsx harmony extra-class"},[n("pre",{pre:!0,attrs:{class:"language-jsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Index")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handleClick1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handleClick2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handleClick3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handleClick4")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClick")]),n("span",{pre:!0,attrs:{class:"token script language-javascript"}},[n("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" handleClick3 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("  "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClickCapture")]),n("span",{pre:!0,attrs:{class:"token script language-javascript"}},[n("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" handleClick4 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n        ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClick")]),n("span",{pre:!0,attrs:{class:"token script language-javascript"}},[n("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" handleClick1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("  "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClickCapture")]),n("span",{pre:!0,attrs:{class:"token script language-javascript"}},[n("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" handleClick2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("点击")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n    ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"_5-1-批量更新"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-批量更新"}},[t._v("#")]),t._v(" 5.1 批量更新")]),t._v(" "),n("p",[n("img",{attrs:{src:s(379),alt:"fiber-dom"}}),t._v(";\n"),n("img",{attrs:{src:s(380),alt:"clickLifeCycle1"}}),t._v(";")]),t._v(" "),n("h3",{attrs:{id:"_5-2-合成事件源"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-合成事件源"}},[t._v("#")]),t._v(" 5.2 合成事件源")]),t._v(" "),n("p",[n("img",{attrs:{src:s(381),alt:"clickLifeCycle2"}})]),t._v(" "),n("h3",{attrs:{id:"_5-3-形成事件执行队列"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-形成事件执行队列"}},[t._v("#")]),t._v(" 5.3 形成事件执行队列")]),t._v(" "),n("p",[n("img",{attrs:{src:s(382),alt:"clickLifeCycle3"}}),t._v(";")]),t._v(" "),n("h3",{attrs:{id:"_5-4-react如何模拟阻止事件冒泡"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-react如何模拟阻止事件冒泡"}},[t._v("#")]),t._v(" 5.4 react如何模拟阻止事件冒泡")]),t._v(" "),n("p",[t._v("::: tips legacy-events/EventBatching.js")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("runEventsInBatch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dispatchListeners "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_dispatchListeners"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Array"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isArray")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dispatchListeners"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" dispatchListeners"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPropagationStopped")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 判断是否已经阻止事件冒泡 */")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("    \n      dispatchListeners"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 执行真正的处理函数 及handleClick1... */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v(":::")]),t._v(" "),n("h2",{attrs:{id:"六、总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#六、总结"}},[t._v("#")]),t._v(" 六、总结")]),t._v(" "),n("ul",[n("li",[t._v("React为什么有自己的事件系统？")])]),t._v(" "),n("p",[t._v("答：因为对于不同的浏览器，对事件存在不同的兼容性，React想实现一个兼容全浏览器的框架，为了实现这个目标，\n就需要创建一个兼容全浏览器的事件系统，以此抹平不同浏览器的差异。")]),t._v(" "),n("ul",[n("li",[t._v("V17对事件系统有哪些改变？")]),t._v(" "),n("li",[t._v("事件是绑定在真实的dom上嘛？如果不是绑定在哪里？")])]),t._v(" "),n("p",[t._v("答："),n("strong",[t._v("V17之前React事件都绑定在document上，V17之后React把事件绑定在应用对应的容器container上")]),t._v("，\n将事件绑定在同一容器统一管理，防止很多事件直接绑定在原生的DOM元素上。造成一些不可控的情况。")]),t._v(" "),n("ul",[n("li",[t._v("什么是事件合成\n答：在React应用中，元素的绑定并不是原生事件，而是React合成的事件，比如onClick是由click合成，\nonChange是有blur，change，focus等多个事件合成。比如原生的checkbox、select没有onChange事件")])]),t._v(" "),n("ol",[n("li",[t._v("什么是事件合成。")]),t._v(" "),n("li",[t._v("如何模拟事件捕获和事件冒泡阶段。")]),t._v(" "),n("li",[t._v("如何处理事件源对象。")]),t._v(" "),n("li",[t._v("一次点击到事件执行都发生了什么。")])])])}),[],!1,null,null,null);a.default=e.exports}}]);