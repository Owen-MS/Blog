# 原理篇-事件原理

## 一、前言
### 首先
在React应用中，我们所看到的React事件都是"假的"。假在哪里？

- 给元素绑定的事件，不是真正的事件处理函数。
- 在冒泡/捕获阶段绑定的事件，也不是在冒泡/捕获阶段执行的。
- 甚至在事件处理函数中拿到的事件源e，也不是真正的事件源e。

### 疑问
- React 为什么有自己的事件系统？ 
- 什么是事件合成 ？ 
- 如何实现的批量更新？
- 事件系统如何模拟冒泡和捕获阶段？
- 如何通过 dom 元素找到与之匹配的fiber？
- 为什么不能用 return false 来阻止事件的默认行为？
- 事件是绑定在真实的dom上吗？如何不是绑定在哪里？
- V17 对事件系统有哪些改变？

由于不是绑定在真实的DOM上，所以React需要模拟一套事件流：事件捕获 -> 事件源 -> 事件冒泡, 也包括重写
一下事件源对象event。


## 二、独特的事件处理
### 冒泡阶段和捕获阶段
- 冒泡阶段：开发者正常给React绑定的事件加上onClick，onChange。默认会在模拟冒泡阶段执行。
- 捕获阶段：如果想要在捕获阶段执行可以将事件后面加上Capture后缀，比如onClickCapture，onChangeCapture

### 阻止冒泡
React阻止冒泡和原生事件中的写法差不多，e.stopPropagation()；但底层原理不同。

### 阻止默认行为
- 原生事件：e.preventDefault()和return false可以用来阻止事件默认行为。
- React事件: e.preventDefault()阻止事件默认行为，这个方法并非是原生事件的preventDefault,
由于React的事件源e也是独立组建的，所以需要显示调用preventDefault来告诉react来阻止默认行为，所以
return false在react应用中完全失去来作用。

## 三、事件合成

React事件系统可分为三个部分：
- 第一部分是在事件合成系统，初始化会注册不同的事件插件。
- 第二部分是在第一次渲染过程中，对事件标签中事件的收集，想container注册事件。
- 第三个部分就是一次用户交互，事件触发，到事件执行的一系列过程。

### 事件合成概念

 
## 四、事件绑定
## 五、事件触发
## 六、总结
- React为什么有自己的事件系统？

答：因为对于不同的浏览器，对事件存在不同的兼容性，React想实现一个兼容全浏览器的框架，为了实现这个目标，
就需要创建一个兼容全浏览器的事件系统，以此抹平不同浏览器的差异。

- V17对事件系统有哪些改变？
- 事件是绑定在真实的dom上嘛？如果不是绑定在哪里？

答：**V17之前React事件都绑定在document上，V17之后React把事件绑定在应用对应的容器container上**，
将事件绑定在同一容器统一管理，防止很多事件直接绑定在原生的DOM元素上。造成一些不可控的情况。



1. 什么是事件合成。
2. 如何模拟事件捕获和事件冒泡阶段。
3. 如何处理事件源对象。
4. 一次点击到事件执行都发生了什么。
