# 21-30

## 21、手写防抖节流-京东

```javascript
function debounce(fn, delay) {
    let timer = null;
    return function () {
        if (timer) clearTimeout(timer);
        timer = setTimeout(() => fn.apply(this, arguments), delay);
    }
}

window.addEventListener(
    "scroll",
    debounce(() => {
        console.log(111);
    }, 1000)
);

```

```javascript
function throttle(fn, delay) {
    let isFlag = false;
    return function () {
        if (isFlag) return;
        isFlag = true;
        setTimeout(() => {
            fn();
            isFlag = false;
        }, delay);
    }
}

window.addEventListener(
    "scroll",
    throttle(() => {
        console.log(111);
    }, 1000)
);
```

## 22、手写，将虚拟Dom转为真是Dom（类似的递归题-必考）；

```
{
  tag: 'DIV',
  attrs:{
  id:'app'
  },
  children: [
    {
      tag: 'SPAN',
      children: [
        { tag: 'A', children: [] }
      ]
    },
    {
      tag: 'SPAN',
      children: [
        { tag: 'A', children: [] },
        { tag: 'A', children: [] }
      ]
    }
  ]
}
把上诉虚拟Dom转化成下方真实Dom
<div id="app">
  <span>
    <a></a>
  </span>
  <span>
    <a></a>
    <a></a>
  </span>
</div>

```

```javascript
function _render(vnode) {
    if (typeof vnode === "number") {
        vnode = String(vnode);
    }
    if (typeof vnode === "string") {
        return document.createTextNode(vnode);
    }
    const dom = document.createElement(vnode.tag);
    if (vnode.attrs) {
        // for(let key in vnode.attrs) {
        //     dom.setAttribute(vnode.attrs[key]);
        // }
        Object.keys(vnode.attrs).forEach(key => {
            dom.setAttribute(vnode.attrs[key]);
        });
    }
    vnode.child.forEach(children => {
        dom.appedChild(_render(children));
    })
    return dom;
}
```

## 23、手写实现一个flatten方法-阿里

```
const obj = {
 a: {
        b: 1,
        c: 2,
        d: {e: 5}
    },
 b: [1, 3, {a: 2, b: 3}],
 c: 3
}

flatten(obj) 结果返回如下
// {
//  'a.b': 1,
//  'a.c': 2,
//  'a.d.e': 5,
//  'b[0]': 1,
//  'b[1]': 3,
//  'b[2].a': 2,
//  'b[2].b': 3
//   c: 3
// }

```

```javascript
function isObject(val) {
    return typeof val === 'object' && val !== null;
}

function flatten(obj) {
    if (!isObject(obj)) return;
    let res = {};

    function dfs(cur, prefix) {
        if (isObject(cur)) {
            if (Array.isArray(cur)) {
                cur.forEach((item, index) => {
                    dfs(item, `${prefix}[${index}]`)
                })
            } else {
                for (let key in cur) {
                    dfs(cur[key], `${prefix}${prefix ? '.' : ''}${key}`)
                }
            }
        } else {
            res[prefix] = cur;
        }
    }

    dfs(obj);
    return res;
}
```

## 24、手写判读字符串是否有效 - 小米

```
给定一个只包括 '('，')'，'{'，'}'，'['，']' 的字符串 s ，判断字符串是否有效。

有效字符串需满足：

    左括号必须用相同类型的右括号闭合。
    左括号必须以正确的顺序闭合。

示例 1：

输入：s = "()"
输出：true

示例 2：

输入：s = "()[]{}"
输出：true

示例 3：

输入：s = "(]"
输出：false

```

```javascript
function isValid(str) {
    if (!str || str.length % 2 === 1) return false;
    const obj = {
        '(': ')',
        '[': ']',
        '{': '}'
    }
    const queue = [];
    for (let i = 0; i < str.length; i++) {
        if (obj[str[i]]) {
            queue.push(str[i])
        } else {
            const cur = queue.shift();
            if (obj[cur] !== str[i]) {
                return false;
            }
        }
    }
    if (queue.length) return false;
    return true;
}
```

## 25、查找数组公共前缀-美团

```
编写一个函数来查找字符串数组中的最长公共前缀。
如果不存在公共前缀，返回空字符串 ""。

示例 1：

输入：strs = ["flower","flow","flight"]
输出："fl"

示例 2：

输入：strs = ["dog","racecar","car"]
输出：""
解释：输入不存在公共前缀。

```

```javascript
function longestCommonPrefix(strArr) {
    const str = strs[0];
    let index = 0;
    while (index < strArr.length) {
        const strCur = str.slice(0, index + 1);
        for(let i = 0; i< strArr.length; i++) {
            if(!strs[i] && !strArr[i].startsWith(strCur)){
                return str.slice(0, index);
            }
        }
        index++;
    }
    return str;
}
```